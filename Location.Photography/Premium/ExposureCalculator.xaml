<?xml version="1.0" encoding="utf-8" ?>
<base:ContentPageBase xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:base="clr-namespace:Location.Photography.Base"
             xmlns:strings="clr-namespace:Location.Photography.Resources"
             xmlns:system="clr-namespace:System;assembly=netstandard"
             xmlns:viewmodels="clr-namespace:Location.Photography.Shared.ViewModels;assembly=Location.Photography.Shared"
             xmlns:converters="clr-namespace:Location.Photography.Converters;assembly=Location.Photography"
             x:Class="Location.Photography.Premium.ExposureCalculator"
             x:DataType="viewmodels:ExposureCalculator"
             Title="Exposure Calculator">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:StringToBoolConverter x:Key="StringToBoolConverter"/>
            <converters:BoolToColorConverter x:Key="BoolToColorConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView>
        <Grid Padding="15,10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Header and close button -->
            <Label Text="Exposure Calculator" FontSize="Large" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3"/>
            <ImageButton Grid.Row="0" Grid.Column="3" 
                         Source="closeoutlinecustom.png" 
                         HorizontalOptions="End" 
                         x:Name="CloseButton" 
                         Pressed="CloseButton_Pressed"
                         IsVisible="False"/>

            <!-- Exposure Increments -->
            <Label Text="{x:Static strings:AppResources.exposureincrements}" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="1" 
                   Grid.ColumnSpan="4"/>

            <RadioButton x:Name="exposurefull" 
                         Content="{x:Static strings:AppResources.full}" 
                         GroupName="Exposure" 
                         Value="0" 
                         Grid.Row="2" 
                         Grid.Column="0" 
                         CheckedChanged="exposuresteps_CheckedChanged"
                         IsChecked="True"/>
            <RadioButton x:Name="exposurehalfstop" 
                         Content="{x:Static strings:AppResources.half}" 
                         GroupName="Exposure" 
                         Value="1" 
                         Grid.Row="2" 
                         Grid.Column="1" 
                         CheckedChanged="exposuresteps_CheckedChanged"/>
            <RadioButton x:Name="exposurethirdstop" 
                         Content="{x:Static strings:AppResources.thirds}" 
                         GroupName="Exposure" 
                         Value="2" 
                         Grid.Row="2" 
                         Grid.Column="2" 
                         CheckedChanged="exposuresteps_CheckedChanged"/>

            <!-- Calculate -->
            <Label Text="{x:Static strings:AppResources.calculate}" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="3" 
                   Grid.ColumnSpan="4"
                   Margin="0,15,0,5"/>

            <RadioButton x:Name="shutter" 
                         Content="{x:Static strings:AppResources.shutterspeednocolon}" 
                         GroupName="Calculate" 
                         Value="0" 
                         Grid.Row="4" 
                         Grid.Column="0" 
                         CheckedChanged="calculate_CheckedChanged"
                         IsChecked="True"/>
            <RadioButton x:Name="aperture" 
                         Content="{x:Static strings:AppResources.aperturenocolon}" 
                         GroupName="Calculate" 
                         Value="3" 
                         Grid.Row="4" 
                         Grid.Column="1" 
                         CheckedChanged="calculate_CheckedChanged"/>
            <RadioButton x:Name="iso" 
                         Content="{x:Static strings:AppResources.isonocolon}" 
                         GroupName="Calculate" 
                         Value="1" 
                         Grid.Row="4" 
                         Grid.Column="2" 
                         CheckedChanged="calculate_CheckedChanged"/>

            <!-- Base Exposure -->
            <Label Text="{x:Static strings:AppResources.baseexposure}" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="5" 
                   Grid.ColumnSpan="4"
                   Margin="0,15,0,5"/>

            <Label Text="{x:Static strings:AppResources.shutterspeed}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="6" 
                   Grid.Column="0"
                   HorizontalOptions="Center"/>
            <Label Text="{x:Static strings:AppResources.fStop}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="6" 
                   Grid.Column="1"
                   HorizontalOptions="Center"/>
            <Label Text="{x:Static strings:AppResources.iso}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="6" 
                   Grid.Column="2"
                   HorizontalOptions="Center"/>

            <Picker x:Name="ShutterSpeed_Picker" 
                    Grid.Row="7" 
                    Grid.Column="0" 
                    ItemsSource="{Binding ShutterSpeedsForPicker}" 
                    SelectedItem="{Binding ShutterSpeedSelected}"
                    SelectedIndexChanged="ShutterSpeed_Picker_SelectedIndexChanged"
                    IsEnabled="False"/>
            <Picker x:Name="fstop_Picker" 
                    Grid.Row="7" 
                    Grid.Column="1" 
                    ItemsSource="{Binding ApeaturesForPicker}" 
                    SelectedItem="{Binding FStopSelected}"
                    SelectedIndexChanged="fstop_Picker_SelectedIndexChanged"/>
            <Picker x:Name="ISO_Picker" 
                    Grid.Row="7" 
                    Grid.Column="2" 
                    ItemsSource="{Binding ISOsForPicker}" 
                    SelectedItem="{Binding ISOSelected}"
                    SelectedIndexChanged="ISO_Picker_SelectedIndexChanged"/>

            <!-- Results -->
            <Label Text="{x:Static strings:AppResources.results}" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="8" 
                   Grid.ColumnSpan="4"
                   Margin="0,15,0,5"/>

            <Label Text="{x:Static strings:AppResources.shutterspeed}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="9" 
                   Grid.Column="0"
                   HorizontalOptions="Center"/>
            <Label Text="{x:Static strings:AppResources.fStop}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="9" 
                   Grid.Column="1"
                   HorizontalOptions="Center"/>
            <Label Text="{x:Static strings:AppResources.iso}" 
                   TextColor="#CC0000" 
                   FontSize="Medium" 
                   FontAttributes="Bold" 
                   Grid.Row="9" 
                   Grid.Column="2"
                   HorizontalOptions="Center"/>

            <Label Text="{Binding ShutterSpeedResult}" 
                   x:Name="shutterspeedresult" 
                   Grid.Row="10" 
                   Grid.Column="0"
                   HorizontalOptions="Center"
                   FontSize="Medium"/>
            <Label Text="{Binding FStopResult}" 
                   x:Name="fstopresult" 
                   Grid.Row="10" 
                   Grid.Column="1"
                   HorizontalOptions="Center"
                   FontSize="Medium"/>
            <Label Text="{Binding ISOResult}" 
                   x:Name="isoresult" 
                   Grid.Row="10" 
                   Grid.Column="2"
                   HorizontalOptions="Center"
                   FontSize="Medium"/>

            <!-- Error message -->
            <Frame IsVisible="{Binding ShowError}" 
                   Grid.Row="11" 
                   Grid.ColumnSpan="4" 
                   BackgroundColor="#FFCCCC" 
                   Padding="10" 
                   Margin="0,15,0,0" 
                   BorderColor="#FF0000">
                <Label x:Name="errorLabel" 
                       Text="{Binding ErrorMessage}" 
                       TextColor="#CC0000"/>
            </Frame>

            <!-- Busy indicator overlay -->
            <Grid IsVisible="{Binding VmIsBusy}" 
                  BackgroundColor="#80000000"
                  Grid.RowSpan="12"
                  Grid.ColumnSpan="4">
                <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                    <ActivityIndicator IsRunning="{Binding VmIsBusy}" 
                                       HeightRequest="50" 
                                       WidthRequest="50" 
                                       Color="White" />
                    <Label Text="Processing, please wait..." 
                           TextColor="White" 
                           Margin="0,10,0,0"/>
                </VerticalStackLayout>
            </Grid>
        </Grid>
    </ScrollView>
</base:ContentPageBase>